{% extends "base.html" %}
{% block title %}Editar Sala - Admin{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="text-white mb-4">
        <i class="bi bi-building-gear"></i> Editar Sala
    </h1>

    <div class="row">
        <!-- Formulario -->
        <div class="col-md-8">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Datos de la Sala</h5>
                </div>
                <div class="card-body">
                    <form method="POST">
                        <div class="mb-3">
                            <label class="form-label">Nombre de la Sala *</label>
                            <input type="text" class="form-control" name="nombre_sala" 
                                   value="{{ sala.nombre_sala }}" required>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Edificio *</label>
                            <select class="form-select" name="edificio" required>
                                {% for edif in edificios %}
                                <option value="{{ edif.nombre_edificio }}" 
                                        {% if edif.nombre_edificio == sala.edificio %}selected{% endif %}>
                                    {{ edif.nombre_edificio }} - {{ edif.direccion }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Capacidad *</label>
                            <input type="number" class="form-control" name="capacidad" 
                                   value="{{ sala.capacidad }}" min="1" max="500" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Tipo de Sala *</label>
                            <select class="form-select" name="tipo_sala" required>
                                {% for tipo in tipos_sala %}
                                <option value="{{ tipo }}" 
                                    {% if tipo == sala.tipo_sala %}selected{% endif %}>
                                    {{ tipo.capitalize() }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>


                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-success">
                                <i class="bi bi-save"></i> Guardar Cambios
                            </button>
                            <a href="{{ url_for('admin_salas') }}" class="btn btn-secondary">
                                <i class="bi bi-arrow-left"></i> Volver
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Estadísticas -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">Estadísticas de Uso</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <h6>Total de Reservas</h6>
                        <h3 class="text-primary">{{ stats.total_reservas }}</h3>
                    </div>
                    
                    <div class="mb-3">
                        <h6>Reservas Activas</h6>
                        <h3 class="text-success">{{ stats.reservas_activas }}</h3>
                    </div>
                    
                    <div class="mb-3">
                        <h6>Tasa de Cancelación</h6>
                        <h3 class="{% if stats.tasa_cancelacion > 20 %}text-danger{% elif stats.tasa_cancelacion > 10 %}text-warning{% else %}text-success{% endif %}">
                            {{ stats.tasa_cancelacion }}%
                        </h3>
                    </div>

                    <hr>

                    <div class="alert alert-warning">
                        <small>
                            <i class="bi bi-exclamation-triangle"></i>
                            No se puede eliminar una sala con reservas activas o futuras
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}